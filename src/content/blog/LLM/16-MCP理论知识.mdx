---
title: MCPç†è®ºçŸ¥è¯†
description: MCPç†è®ºçŸ¥è¯†
pubDate: 2025-10-09
toc: true
ogImage: true
category: LLM
---

## stdio

è¿›ç¨‹ï¼šæ‰§è¡Œä¸€ä¸ªåº”ç”¨ç¨‹åºï¼Œå°±ä¼šå¯åŠ¨ä¸€ä¸ªè¿›ç¨‹ï¼Œæ“ä½œç³»ç»Ÿä¼šä¸ºå…¶åˆ†é…å†…å­˜ç©ºé—´ã€ç³»ç»Ÿèµ„æºã€‚

åº”ç”¨ç¨‹åºæ‰§è¡Œå®Œæ¯•åï¼Œç³»ç»Ÿåˆ†é…ç»™è¿›ç¨‹çš„èµ„æºå°±ä¼šè¢«å›æ”¶ã€‚

**è¯¾å ‚æ¼”ç¤º**

è¿›ç¨‹ä¹‹é—´æ˜¯å¯ä»¥é€šä¿¡çš„ã€‚é‚£è¿™é‡Œæœ‰ä¸€ä¸ªæœ€åŸºæœ¬çš„è¦æ±‚ï¼šè¿›ç¨‹ä¸èƒ½ç»“æŸã€‚å¦‚ä½•è®©è¿›ç¨‹ä¸ç»“æŸï¼Ÿ

æƒ³æƒ³å¾®ä¿¡ã€QQå¯åŠ¨åä¸ºå•¥ä¸ç»“æŸï¼Ÿ

å› ä¸ºè¦ç›‘å¬ã€‚

<img
  src="https://xiejie-typora.oss-cn-chengdu.aliyuncs.com/2025-07-14-153745.png"
  alt="image-20250714233744304"
  style="zoom:40%;"
/>

è¿™é‡Œä¹ŸåŒæ ·ï¼Œåªè¦è¿›ç¨‹å¤„äºç›‘å¬çŠ¶æ€ï¼Œå°±ä¸ä¼šç»“æŸã€‚

```js
// ç›‘å¬è¾“å…¥
process.stdin.on('data', () => {})
```

é™¤æ­¤ä¹‹å¤–ï¼Œ**ä¸€ä¸ªè¿›ç¨‹è¿˜å¯ä»¥å¯åŠ¨å¦ä¸€ä¸ªè¿›ç¨‹**ï¼Œè¿™åœ¨æ“ä½œç³»ç»Ÿä¸­æ˜¯éå¸¸å¸¸è§å’Œå¸¸ç”¨çš„è¡Œä¸ºï¼Œè¢«ç§°ä¹‹ä¸º **çˆ¶å­è¿›ç¨‹æ¨¡å‹**ã€‚

æ§åˆ¶å°å…¶å®ä¹Ÿæ˜¯ä¸€ä¸ªåº”ç”¨ç¨‹åºï¼Œå¯åŠ¨åä¹Ÿä¼šæœ‰è¿›ç¨‹ã€‚å› æ­¤ä¸‹é¢çš„ä»£ç ï¼š

```bash
node index.js
```

æ§åˆ¶å°å°±æ˜¯çˆ¶è¿›ç¨‹ï¼Œnodeç¨‹åºå°±æ˜¯å­è¿›ç¨‹ã€‚

<img
  src="https://xiejie-typora.oss-cn-chengdu.aliyuncs.com/2025-07-14-153219.png"
  alt="image-20250714233218827"
  style="zoom:40%;"
/>

ğŸ™‹ è®©ç»ˆç«¯å’Œ node ç¨‹åºè¿›è¡Œé€šä¿¡ï¼Œè¯¥å¦‚ä½•è¿›è¡Œé€šä¿¡ï¼Ÿ

stdio: **st**an**d**ard **i**nput and **o**utput æ ‡å‡†è¾“å…¥è¾“å‡º

æ¯ä¸€ä¸ªè¿›ç¨‹å¯åŠ¨åï¼Œéƒ½ä¼šç•™å‡ºä¸¤ä¸ªå¯¹å¤–é€šä¿¡çš„æ¥å£ï¼š

- æ ‡å‡†è¾“å…¥æ¥å£ï¼šstandard in
- æ ‡å‡†è¾“å‡ºæ¥å£ï¼šstandard output

ä¸Šé¢è¿›ç¨‹ç›‘å¬è¾“å…¥å’Œå¯¹å¤–è¾“å‡ºçš„å›¾ï¼Œå°±å¯ä»¥å˜æˆè¿™æ ·ï¼š

<img
  src="https://resource.duyiedu.com/yuanjin/202507121302745.png"
  alt="image-20250712130252722"
  style="zoom: %;"
/>

ç»“åˆå‰é¢çˆ¶å­æ¨¡å‹çš„çŸ¥è¯†ï¼š

<img
  src="https://resource.duyiedu.com/yuanjin/202507121308463.png"
  alt="image-20250712130835444"
  style="zoom:50%;"
/>

**è¯¾å ‚ç»ƒä¹ **

ç»ˆç«¯å’Œ node è¿›ç¨‹é€šä¿¡

å†çœ‹ä¸‹é¢çš„ä¾‹å­ï¼Œå¢åŠ ä¸€ä¸ª client.js

```js
const { spawn } = require('child_process')

// å¯åŠ¨ server.js å­è¿›ç¨‹
const serverProcess = spawn('node', ['server.js']) // node server.js

// ç›‘å¬æœåŠ¡ç«¯çš„å“åº”
// æ•°æ®ä»å“ªé‡Œæ¥ï¼Ÿå“ªä¸ªè¿›ç¨‹ç»™æˆ‘çš„
// æ•°æ®ä¼šè¾“å‡ºåˆ°å“ªå„¿ï¼Ÿæˆ‘ç»™å“ªä¸ªè¿›ç¨‹
serverProcess.stdout.on('data', (data) => {
  process.stdin.write(data.toString()) // ğŸ™‹ å¾€å“ªé‡Œè¾“å‡ºï¼Ÿ
})

// å‘é€å‡ æ¡æµ‹è¯•æ¶ˆæ¯
const messages = ['ç”Ÿå‘½æœ‰æ„ä¹‰å—ï¼Ÿ', 'å®‡å®™æœ‰å°½å¤´å—ï¼Ÿ', 'å†è§ï¼']

messages.forEach((msg, index) => {
  setTimeout(() => {
    console.log(`-->${msg}`)
    serverProcess.stdin.write(msg)
  }, index * 1000) // æ¯ç§’å‘ä¸€æ¡
})
```

å¦‚ä¸‹å›¾ï¼š

![image-20250715000332368](https://xiejie-typora.oss-cn-chengdu.aliyuncs.com/2025-07-14-160333.png)

stdioé€šä¿¡é«˜æ•ˆã€ç®€æ´ï¼Œä½†ä»…é€‚ç”¨äºæœ¬åœ°è¿›ç¨‹é—´é€šä¿¡

## é€šä¿¡æ ¼å¼

é€šä¿¡æ¶‰åŠåˆ°æ•°æ®ä¼ è¾“ï¼Œæ•°æ®ä¼ è¾“çš„æ ¼å¼æœ‰å¤šç§ï¼š

- xml
- json
- å­—ç¬¦ä¸²

**JSON-RPC2.0**

è‹±è¯­å…¨ç§°ä¸º JSON Remote Procedure Callï¼Œè¿œç¨‹å‡½æ•°è°ƒç”¨ã€‚

request

```json
{
  "jsonrpc": "2.0",
  "method": "sum",
  "params": {
    "a": 5,
    "b": 6
  },
  "id": 1
}
```

response

```json
{
  "jsonrpc": "2.0",
  "result": 11,
  "id": 1
}
```

**è¯¾å ‚ç»ƒä¹ **

å®ç°åŸºäº JSON-RPC çš„é€šä¿¡

## MCP Server

MCPæ˜¯ä¸€å¥— **æ ‡å‡†åè®®**ï¼Œ å®ƒè§„å®šäº† **åº”ç”¨ç¨‹åº** ä¹‹é—´ **å¦‚ä½•é€šä¿¡**

å¦‚ä½•é€šä¿¡ï¼š

- é€šä¿¡æ–¹å¼
  - stdioï¼š æ¨èï¼Œé«˜æ•ˆã€ç®€æ´ã€æœ¬åœ°
  - httpï¼š å¯è¿œç¨‹
    - StreamHTTP
    - SSE
- é€šä¿¡æ ¼å¼ï¼š åŸºäºJSON-RPCçš„è¿›ä¸€æ­¥è§„èŒƒ

### åŸºæœ¬è§„èŒƒ

**1. åˆå§‹åŒ– initialize**

ä¸¤ä¸ªåº”ç”¨ç¨‹åºè¦å¼€å§‹é€šä¿¡ï¼Œé¦–å…ˆéœ€è¦åˆå§‹åŒ–

request

```json
{
  "jsonrpc": "2.0",
  "id": 1,
  "method": "initialize", // å›ºå®šä¸º initialize
  "params": {
    "protocolVersion": "2024-11-05",
    "capabilities": {
      "roots": {
        "listChanged": true
      },
      "sampling": {},
      "elicitation": {}
    },
    "clientInfo": {
      // å‘ŠçŸ¥æœåŠ¡å™¨å®¢æˆ·ç«¯çš„ä¿¡æ¯
      "name": "ExampleClient",
      "title": "Example Client Display Name",
      "version": "1.0.0"
    }
  }
}
```

response

```json
{
  "jsonrpc": "2.0",
  "id": 1,
  "result": {
    "protocolVersion": "2024-11-05",
    "capabilities": {
      "logging": {},
      "prompts": {
        "listChanged": true
      },
      "resources": {
        "subscribe": true,
        "listChanged": true
      },
      "tools": {
        "listChanged": true
      }
    },
    "serverInfo": {
      // æœåŠ¡ç«¯ä¿¡æ¯
      "name": "ExampleServer",
      "title": "Example Server Display Name",
      "version": "1.0.0"
    },
    "instructions": "Optional instructions for the client"
  }
}
```

**2. å‘ç°å·¥å…· `tools/list`**

æœåŠ¡å™¨æœ‰å“ªäº›å·¥å…·å‡½æ•°å¯ä»¥ä¾›å®¢æˆ·ç«¯è°ƒç”¨

request

```json
{
  "jsonrpc": "2.0",
  "id": 1,
  "method": "tools/list"
}
```

response

```json
{
  "jsonrpc": "2.0",
  "id": 1,
  "result": {
    "tools": [
      {
        "name": "get_weather",
        "title": "Weather Information Provider",
        "description": "Get current weather information for a location",
        "inputSchema": {
          "type": "object",
          "properties": {
            "location": {
              "type": "string",
              "description": "City name or zip code"
            }
          },
          "required": ["location"]
        }
      }
    ]
  }
}
```

**3. å·¥å…·è°ƒç”¨ `tools/call`**

request

```json
{
  "jsonrpc": "2.0",
  "id": 2,
  "method": "tools/call", // è°ƒç”¨å·¥å…·
  "params": {
    "name": "get_weather", // å·¥å…·åï¼Œå¯¹åº”å·¥å…·å‘ç°ä¸­çš„name
    "arguments": {
      // å·¥å…·å‚æ•°ï¼Œéœ€è¦å’Œå·¥å…·å‘ç°ä¸­çš„ç»“æ„ä¸€è‡´
      "location": "New York"
    }
  }
}
```

response

```json
{
  "jsonrpc": "2.0",
  "id": 2,
  "result": {
    "content": [
      {
        // å‡½æ•°ç»“æœéœ€è¦æ”¾åˆ°contentå­—æ®µä¸­ï¼Œå¦‚æœæœ‰å¤šä¸ªï¼Œä½¿ç”¨æ•°ç»„
        // å‡½æ•°ç»“æœçš„ç±»å‹
        // æ”¯æŒçš„ç±»å‹ï¼š https://modelcontextprotocol.io/specification/2025-06-18/server/tools#tool-result
        "type": "text",
        "text": "72Â°F"
      }
    ]
  }
}
```

å·¥å…·è¿”å›çš„ç±»å‹æœ‰ [å¤šç§](https://modelcontextprotocol.io/specification/2025-06-18/server/tools#tool-result)

**è¯¾å ‚ç»ƒä¹ **

å®ç°éµå¾ª MCP åè®®çš„æœåŠ¡å™¨

ğŸ¤” æœåŠ¡å™¨æ˜¯å¦èƒ½å¤Ÿå’Œå…¶å®ƒéµå¾ªMCPåè®®çš„åº”ç”¨ç¨‹åºé€šä¿¡ï¼Ÿ

### è°ƒè¯•å·¥å…·

æœåŠ¡å™¨ç›®å½•ä¸‹ï¼Œç›´æ¥è¿è¡Œ

```bash
npx @modelcontextprotocol/inspector
```

## å®˜æ–¹SDK

éä¸šåŠ¡ä»£ç ï¼Œä¸€èˆ¬å°±ä¼šå°è£…å‡ºæ¥ã€‚

ä½¿ç”¨`@modelcontextprotocol/sdk`å¯ä»¥æ›´æ–¹ä¾¿çš„å¼€å‘`MCP Server`

```bash
npm install @modelcontextprotocol/sdk
```

**è¯¾å ‚ç»ƒä¹ **

ä½¿ç”¨å®˜æ–¹SDKå®ç° MCP æœåŠ¡å™¨

## å¯¹æ¥AIåº”ç”¨

ä»€ä¹ˆæ˜¯AIåº”ç”¨ç¨‹åºï¼Ÿ

æ‰€æœ‰èƒ½ä¸å¤§æ¨¡å‹äº¤äº’çš„åº”ç”¨éƒ½å¯ä»¥çœ‹ä½œæ˜¯AIåº”ç”¨ç¨‹åº

å¸¸è§çš„AIåº”ç”¨ç¨‹åºï¼š

- ChatGPT
- DeepSeek Chat Page
- Claude Desktop
- VSCode
- Cursor
- ...

å‡¡æ˜¯æ”¯æŒ MCP åè®®çš„ AI åº”ç”¨ï¼Œå°±å¯ä»¥å……å½“å®¢æˆ·ç«¯ï¼Œè¿æ¥ MCP æœåŠ¡å™¨ã€‚

- Claude Desktop
  æ”¯æŒMCPåè®®ï¼Œå¯å……å½“MCPå®¢æˆ·ç«¯
  https://claude.ai/download
- Cursor
  æ”¯æŒMCPåè®®ï¼Œå¯å……å½“MCPå®¢æˆ·ç«¯
  https://cursor.com/cn

æ•´ä¸ªæµç¨‹å¦‚ä¸‹å›¾ï¼š

ç”¨æˆ·å’Œ AI åº”ç”¨è¿›è¡Œäº¤äº’ï¼ŒAI åº”ç”¨èƒŒåè°ƒç”¨çš„æ˜¯å¤§æ¨¡å‹ã€‚

![image-20250715111953921](https://xiejie-typora.oss-cn-chengdu.aliyuncs.com/2025-07-15-031954.png)

ä½†æ˜¯æœ‰äº›äº‹æƒ…ï¼Œå¤§æ¨¡å‹åŠä¸åˆ°ã€‚

<img
  src="https://xiejie-typora.oss-cn-chengdu.aliyuncs.com/2025-07-15-032130.png"
  alt="image-20250715112129621"
  style="zoom:50%;"
/>

æ­¤æ—¶å¯ä»¥é€šè¿‡ MCP æœåŠ¡å™¨æ‰©å®½å¤§æ¨¡å‹çš„èƒ½åŠ›è¾¹ç•Œã€‚

ğŸ¤” å·¥å…·æ˜¯è°è°ƒç”¨ï¼Œå¤§æ¨¡å‹è°ƒç”¨ä¹ˆï¼Ÿ

ä¸æ˜¯å¤§æ¨¡å‹è°ƒç”¨ï¼Œå¤§æ¨¡å‹åªæ¥æ”¶ **è¾“å…¥** å’Œ **è¾“å‡º**ã€‚

æ‰€ä»¥å¤§æ¨¡å‹ä¼šå›å¤ï¼šæˆ‘éœ€è¦è°ƒç”¨ XXX å·¥å…·ã€‚

![image-20250715113151070](https://xiejie-typora.oss-cn-chengdu.aliyuncs.com/2025-07-15-033151.png)

ç„¶å AI åº”ç”¨è°ƒç”¨å·¥å…·ï¼Œå°†å·¥å…·è°ƒç”¨ç»“æœè¿”å›ç»™å¤§æ¨¡å‹ã€‚

![image-20250715113402639](https://xiejie-typora.oss-cn-chengdu.aliyuncs.com/2025-07-15-033403.png)

ä¸¤ä¸ªæ ¸å¿ƒæ¦‚å¿µï¼š

- `MCP Host`: å¾€å¾€æŒ‡ä»£AIåº”ç”¨æœ¬èº«ï¼Œç”¨äºå‘ç°MCP Serverä»¥åŠå…¶ä¸­çš„å·¥å…·åˆ—è¡¨
- `MCP Client`ï¼š ç”¨äºå’ŒMCP Serveré€šä¿¡çš„å®¢æˆ·ç«¯ï¼Œå¾€å¾€åœ¨Hostå†…éƒ¨å¼€å¯ï¼Œé€šå¸¸æƒ…å†µä¸‹ï¼Œæ¯å¯åŠ¨ä¸€ä¸ªMCP Serverï¼Œå°±ä¼šå¼€å¯ä¸€ä¸ªMCP Client

![image-20250712222733393](https://resource.duyiedu.com/yuanjin/202507122227442.png)

ä¾‹å¦‚ï¼š

1. åœ¨Claude Desk ä¸­æ‰“å¼€ä¸€ä¸ªæ–°çš„èŠå¤©çª—å£
2. ClaudeæŸ¥çœ‹å½“å‰å¯ç”¨äº†å“ªäº›MCP Server
3. Claudeï¼ˆhostï¼‰ä¸ºæ¯ä¸ªMCP Serveråˆ›å»ºä¸€ä¸ªClient
4. æ¯ä¸ªClientåˆ†åˆ«å¯åŠ¨å„è‡ªçš„MCP Serverï¼Œå¹¶ä¸”è¿›è¡Œäº†2æ¬¡é€šä¿¡ï¼Œä¸€æ¬¡æ˜¯åˆå§‹åŒ–ï¼Œå¦å¤–ä¸€æ¬¡æ˜¯tools/listã€‚
5. å½“æ—¶æœºåˆ°è¾¾æ—¶ï¼ˆè¦è°ƒç”¨å·¥å…·çš„æ—¶å€™ï¼‰ï¼Œæ¯ä¸ªClientè´Ÿè´£è°ƒç”¨å„è‡ªçš„å·¥å…·å¹¶æŠŠç»“æœä¼ é€’ç»™Host
6. Hostæ ¹æ®ç»“æœå¤„ç†åç»­é€»è¾‘
